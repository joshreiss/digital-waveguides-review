<h2> Controlling the Pitch </h2>
The first model's pitch was simply determined by the delay length. But not, the pitch can change when the inner filter's frequency changes.
Digital filters are based on delay. So by introducing a filter, we're changing the total length of the cumulative delay line. In fact, the filters we're using have a phase delay that's different for every frequency. This makes it more difficult to find an exact solution to compensate for this delay, as the filter introduces slight inharmonicity, and it affects the pitch in a way that depends on the pitch. Thankfully we don't actually need to use our brains: we can use regression instead! Just measure how the filter affects the pitch and fit an equation onto it. For simple lowpass filters, we obtain something in the form:
<math><mi>K</mi><mo>=</mo><mfrac><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow><mrow><mi>f</mi><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><msup><mi>f</mi><mn>2</mn></msup><mo>/</mo><msub><mi>f</mi><mi>c</mi></msub></mrow></mfrac></math>

where:
<ul>
<li><em>K</em> is the delay length
<li><em>f</em> is the desired pitch
<li><em>f<sub>c</sub></em> is the cutoff frequency of the inner filter
<li>c1 and c2 are constants tied to the inner filter algorithm being used
</ul>
A waveguide model playing a melody. For the simple 1-pole filter used here, we obtain the constants c1≈0.1786 and c2≈1.011
